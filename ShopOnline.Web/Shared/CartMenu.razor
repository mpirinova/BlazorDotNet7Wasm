@implements IDisposable
@inject IShoppingCartService shoppingCartService

<MudBadge Content="@shoppingCartItemCount" Color="Color.Info" Overlap="true" Bordered="true" Class="mx-6 my-4">
    <MudButton Href="cart" Color="Color.Info" Variant="Variant.Filled" DisableElevation="true">
        <MudIcon Icon="@Icons.Material.Filled.ShoppingCart" />&nbsp;Cart
    </MudButton>
</MudBadge>

@code {
    private int shoppingCartItemCount = 0;

    protected override void OnInitialized()
    {
        shoppingCartService.OnCartQuantityChanged += ShoppingCartChanged;
    }

    protected void ShoppingCartChanged(int totalQty)
    {
        shoppingCartItemCount = totalQty;
        StateHasChanged();
    }

    void IDisposable.Dispose()
    {
        shoppingCartService.OnCartQuantityChanged -= ShoppingCartChanged;
    }
}
